<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script><link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Kafkaä¸Debeziumæ„å»ºCDCç®¡é“ | pinkhello</title>
<link rel=canonical href=https://pinkhello.cc/posts/13-kafka%E4%B8%8Edebezium%E6%9E%84%E5%BB%BAcdc%E7%AE%A1%E9%81%93/><meta name=description content="ğŸ‘·Hey! æˆ‘æ˜¯ **pinkhello**ï¼ŒğŸ’» ä¸€ååç«¯ç¨‹åºå‘˜ã€‚**é‡è¦æç¤º**: åœ¨æ‚¨é˜…è¯»æ–‡ç« å¹¶è¯„è®ºä¹‹å‰ï¼Œè¯·å…ˆè®¤çœŸé˜…è¯»[**è¯„è®ºæ‰¿è¯º**](http://pinkhello.cc/promise)ã€‚"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Kafkaä¸Debeziumæ„å»ºCDCç®¡é“"><meta property="og:description" content="å»ºè®¾ç¯‡ 1ã€ä»€ä¹ˆæ˜¯ debezium? https://debezium.io/
Tutorial https://debezium.io/documentation/reference/1.3/tutorial.html
2ã€Debezium å¦‚ä½•å·¥ä½œçš„ 2.1 Debezium æ”¯æŒçš„æ•°æ®åº“ç±»å‹ MySQL MongoDB PostgreSQL Oracle SQL Server Db2 Cassandra 2.2 Debezium ä¸‰ç§æ–¹å¼è¿è¡Œ Kafka Connect Debezium Server Embedded Engine https://github.com/debezium/debezium-examples/tree/master/kinesis
3ã€åœ¨ K8S ä¸­æ„å»ºåŸºç¡€Debeziumé›†ç¾¤ç¯å¢ƒ é•œåƒå‡†å¤‡
kafka | debezium https://hub.docker.com/r/debezium/kafka zookeeper | debezium https://hub.docker.com/r/debezium/zookeeper connect | debezium https://hub.docker.com/r/debezium/connect schema-registry | confluentinc https://hub.docker.com/r/confluentinc/cp-schema-registry psï¼š debezium å‚è€ƒåœ°å€ https://github.com/debezium/docker-images confluentinc å‚è€ƒåœ°å€ https://github.com/confluentinc/cp-all-in-one/tree/latest/cp-all-in-one
3.1 K8SåŸºç¡€çŸ¥è¯† kafka ä¸ zookeeper å»ºè®¾ä¸º stateful çŠ¶æ€é›†ç¾¤ schema-registry ä¸»è¦ä¸ºäº† æ”¯æŒ avro æ ¼å¼è¿™äº›ä¸éœ€è¦å†™åˆ° kafka æ¶ˆæ¯å¤´é‡Œé¢ï¼Œå‡å°‘æ¶ˆæ¯çš„å¤§å°ï¼Œé¢å¤–çš„æœåŠ¡ï¼Œå±äº kafka ç”Ÿæ€ï¼Œå­˜å‚¨ä¾èµ– kafka brokerä¿è¯ç¨³å®šæ€§ã€‚ k8s steteful é›†ç¾¤ 0&mldr;~ n ä¸ª POD zookeeper é‡Œé¢ zoo."><meta property="og:type" content="article"><meta property="og:url" content="https://pinkhello.cc/posts/13-kafka%E4%B8%8Edebezium%E6%9E%84%E5%BB%BAcdc%E7%AE%A1%E9%81%93/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-05-04T08:00:00+08:00"><meta property="article:modified_time" content="2021-05-04T08:00:00+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Kafkaä¸Debeziumæ„å»ºCDCç®¡é“"><meta name=twitter:description content="å»ºè®¾ç¯‡ 1ã€ä»€ä¹ˆæ˜¯ debezium? https://debezium.io/
Tutorial https://debezium.io/documentation/reference/1.3/tutorial.html
2ã€Debezium å¦‚ä½•å·¥ä½œçš„ 2.1 Debezium æ”¯æŒçš„æ•°æ®åº“ç±»å‹ MySQL MongoDB PostgreSQL Oracle SQL Server Db2 Cassandra 2.2 Debezium ä¸‰ç§æ–¹å¼è¿è¡Œ Kafka Connect Debezium Server Embedded Engine https://github.com/debezium/debezium-examples/tree/master/kinesis
3ã€åœ¨ K8S ä¸­æ„å»ºåŸºç¡€Debeziumé›†ç¾¤ç¯å¢ƒ é•œåƒå‡†å¤‡
kafka | debezium https://hub.docker.com/r/debezium/kafka zookeeper | debezium https://hub.docker.com/r/debezium/zookeeper connect | debezium https://hub.docker.com/r/debezium/connect schema-registry | confluentinc https://hub.docker.com/r/confluentinc/cp-schema-registry psï¼š debezium å‚è€ƒåœ°å€ https://github.com/debezium/docker-images confluentinc å‚è€ƒåœ°å€ https://github.com/confluentinc/cp-all-in-one/tree/latest/cp-all-in-one
3.1 K8SåŸºç¡€çŸ¥è¯† kafka ä¸ zookeeper å»ºè®¾ä¸º stateful çŠ¶æ€é›†ç¾¤ schema-registry ä¸»è¦ä¸ºäº† æ”¯æŒ avro æ ¼å¼è¿™äº›ä¸éœ€è¦å†™åˆ° kafka æ¶ˆæ¯å¤´é‡Œé¢ï¼Œå‡å°‘æ¶ˆæ¯çš„å¤§å°ï¼Œé¢å¤–çš„æœåŠ¡ï¼Œå±äº kafka ç”Ÿæ€ï¼Œå­˜å‚¨ä¾èµ– kafka brokerä¿è¯ç¨³å®šæ€§ã€‚ k8s steteful é›†ç¾¤ 0&mldr;~ n ä¸ª POD zookeeper é‡Œé¢ zoo."><link rel=stylesheet href=https://pinkhello.cc/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="><link rel=stylesheet href=https://pinkhello.cc/css/pinkhello.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://pinkhello.cc/images/favicon.ico><script>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-M2FXWC325L","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/categories>Category</a></li><li><a href=/tags>Tag</a></li><li><a href=/index.xml>Rss</a></li><li><a href=/jobs>Job</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://pinkhello.cc/posts/12-%E8%81%8A%E8%81%8A%E8%9D%99%E8%9D%A0chat/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://pinkhello.cc/posts/14-%E5%B7%A5%E4%BD%9C%E7%BA%AA%E5%AE%9E2020/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&text=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&title=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&is_video=false&description=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93&body=Check out this article: https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&title=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&title=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&name=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93&description=%e5%bb%ba%e8%ae%be%e7%af%87%201%e3%80%81%e4%bb%80%e4%b9%88%e6%98%af%20debezium%3f%20https%3a%2f%2fdebezium.io%2f%0aTutorial%20https%3a%2f%2fdebezium.io%2fdocumentation%2freference%2f1.3%2ftutorial.html%0a2%e3%80%81Debezium%20%e5%a6%82%e4%bd%95%e5%b7%a5%e4%bd%9c%e7%9a%84%202.1%20Debezium%20%e6%94%af%e6%8c%81%e7%9a%84%e6%95%b0%e6%8d%ae%e5%ba%93%e7%b1%bb%e5%9e%8b%20MySQL%20MongoDB%20PostgreSQL%20Oracle%20SQL%20Server%20Db2%20Cassandra%202.2%20Debezium%20%e4%b8%89%e7%a7%8d%e6%96%b9%e5%bc%8f%e8%bf%90%e8%a1%8c%20Kafka%20Connect%20Debezium%20Server%20Embedded%20Engine%20https%3a%2f%2fgithub.com%2fdebezium%2fdebezium-examples%2ftree%2fmaster%2fkinesis%0a3%e3%80%81%e5%9c%a8%20K8S%20%e4%b8%ad%e6%9e%84%e5%bb%ba%e5%9f%ba%e7%a1%80Debezium%e9%9b%86%e7%be%a4%e7%8e%af%e5%a2%83%20%e9%95%9c%e5%83%8f%e5%87%86%e5%a4%87%0akafka%20%7c%20debezium%20https%3a%2f%2fhub.docker.com%2fr%2fdebezium%2fkafka%20zookeeper%20%7c%20debezium%20https%3a%2f%2fhub.docker.com%2fr%2fdebezium%2fzookeeper%20connect%20%7c%20debezium%20https%3a%2f%2fhub.docker.com%2fr%2fdebezium%2fconnect%20schema-registry%20%7c%20confluentinc%20https%3a%2f%2fhub.docker.com%2fr%2fconfluentinc%2fcp-schema-registry%20ps%ef%bc%9a%20debezium%20%e5%8f%82%e8%80%83%e5%9c%b0%e5%9d%80%20https%3a%2f%2fgithub.com%2fdebezium%2fdocker-images%20confluentinc%20%e5%8f%82%e8%80%83%e5%9c%b0%e5%9d%80%20https%3a%2f%2fgithub.com%2fconfluentinc%2fcp-all-in-one%2ftree%2flatest%2fcp-all-in-one%0a3.1%20K8S%e5%9f%ba%e7%a1%80%e7%9f%a5%e8%af%86%20kafka%20%e4%b8%8e%20zookeeper%20%e5%bb%ba%e8%ae%be%e4%b8%ba%20stateful%20%e7%8a%b6%e6%80%81%e9%9b%86%e7%be%a4%20schema-registry%20%e4%b8%bb%e8%a6%81%e4%b8%ba%e4%ba%86%20%e6%94%af%e6%8c%81%20avro%20%e6%a0%bc%e5%bc%8f%e8%bf%99%e4%ba%9b%e4%b8%8d%e9%9c%80%e8%a6%81%e5%86%99%e5%88%b0%20kafka%20%e6%b6%88%e6%81%af%e5%a4%b4%e9%87%8c%e9%9d%a2%ef%bc%8c%e5%87%8f%e5%b0%91%e6%b6%88%e6%81%af%e7%9a%84%e5%a4%a7%e5%b0%8f%ef%bc%8c%e9%a2%9d%e5%a4%96%e7%9a%84%e6%9c%8d%e5%8a%a1%ef%bc%8c%e5%b1%9e%e4%ba%8e%20kafka%20%e7%94%9f%e6%80%81%ef%bc%8c%e5%ad%98%e5%82%a8%e4%be%9d%e8%b5%96%20kafka%20broker%e4%bf%9d%e8%af%81%e7%a8%b3%e5%ae%9a%e6%80%a7%e3%80%82%20k8s%20steteful%20%e9%9b%86%e7%be%a4%200%26hellip%3b~%20n%20%e4%b8%aa%20POD%20zookeeper%20%e9%87%8c%e9%9d%a2%20zoo." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&t=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Kafkaä¸Debeziumæ„å»ºCDCç®¡é“</h1><div class=meta><div class=postdate><time datetime="2021-05-04 08:00:00 +0800 +0800" itemprop=datePublished>2021-05-04</time></div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=/categories/tech>Tech</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/bigdata rel=tag>bigdata</a>
,
<a class=tag-link href=/tags/kafka rel=tag>kafka</a></div></div></header><div id=toc><nav id=TableOfContents><ul><li><a href=#1ä»€ä¹ˆæ˜¯-debezium>1ã€ä»€ä¹ˆæ˜¯ debezium?</a></li><li><a href=#2debezium-å¦‚ä½•å·¥ä½œçš„>2ã€Debezium å¦‚ä½•å·¥ä½œçš„</a><ul><li><a href=#21-debezium-æ”¯æŒçš„æ•°æ®åº“ç±»å‹>2.1 Debezium æ”¯æŒçš„æ•°æ®åº“ç±»å‹</a></li><li><a href=#22-debezium-ä¸‰ç§æ–¹å¼è¿è¡Œ>2.2 Debezium ä¸‰ç§æ–¹å¼è¿è¡Œ</a></li></ul></li><li><a href=#3åœ¨-k8s-ä¸­æ„å»ºåŸºç¡€debeziumé›†ç¾¤ç¯å¢ƒ>3ã€åœ¨ K8S ä¸­æ„å»ºåŸºç¡€Debeziumé›†ç¾¤ç¯å¢ƒ</a><ul><li><a href=#31-k8såŸºç¡€çŸ¥è¯†>3.1 K8SåŸºç¡€çŸ¥è¯†</a></li><li><a href=#32-zookeeper-æ„å»º>3.2 zookeeper æ„å»º</a></li><li><a href=#33-kafka-æ„å»º>3.3 kafka æ„å»º</a></li><li><a href=#33-kafka-schema-registry-æ„å»º>3.3 kafka schema-registry æ„å»º</a></li><li><a href=#33-kafka-connect-å»ºè®¾>3.3 kafka connect å»ºè®¾</a></li></ul></li></ul><ul><li><a href=#1hudi-data-lake>1ã€Hudi Data Lakeï¼Ÿ</a></li><li><a href=#2timeline>2ã€Timeline</a></li><li><a href=#3hudi-çš„å­˜å‚¨ç±»å‹>3ã€Hudi çš„å­˜å‚¨ç±»å‹</a></li></ul></nav></div><div class=content itemprop=articleBody><h1 id=å»ºè®¾ç¯‡>å»ºè®¾ç¯‡</h1><h2 id=1ä»€ä¹ˆæ˜¯-debezium>1ã€ä»€ä¹ˆæ˜¯ debezium?</h2><p><a href=https://debezium.io/>https://debezium.io/</a></p><p>Tutorial
<a href=https://debezium.io/documentation/reference/1.3/tutorial.html>https://debezium.io/documentation/reference/1.3/tutorial.html</a></p><h2 id=2debezium-å¦‚ä½•å·¥ä½œçš„>2ã€Debezium å¦‚ä½•å·¥ä½œçš„</h2><p><img src=/Kafka%E4%B8%8EDebezium%E6%9E%84%E5%BB%BACDC%E7%AE%A1%E9%81%93/debezium-architecture.png alt=Debeziumå·¥ä½œæµç¨‹></p><h3 id=21-debezium-æ”¯æŒçš„æ•°æ®åº“ç±»å‹>2.1 Debezium æ”¯æŒçš„æ•°æ®åº“ç±»å‹</h3><ul><li>MySQL</li><li>MongoDB</li><li>PostgreSQL</li><li>Oracle</li><li>SQL Server</li><li>Db2</li><li>Cassandra</li></ul><h3 id=22-debezium-ä¸‰ç§æ–¹å¼è¿è¡Œ>2.2 Debezium ä¸‰ç§æ–¹å¼è¿è¡Œ</h3><ul><li>Kafka Connect</li><li>Debezium Server</li><li>Embedded Engine</li></ul><p><a href=https://github.com/debezium/debezium-examples/tree/master/kinesis>https://github.com/debezium/debezium-examples/tree/master/kinesis</a></p><h2 id=3åœ¨-k8s-ä¸­æ„å»ºåŸºç¡€debeziumé›†ç¾¤ç¯å¢ƒ>3ã€åœ¨ K8S ä¸­æ„å»ºåŸºç¡€Debeziumé›†ç¾¤ç¯å¢ƒ</h2><p>é•œåƒå‡†å¤‡</p><ul><li>kafka | debezium <a href=https://hub.docker.com/r/debezium/kafka>https://hub.docker.com/r/debezium/kafka</a></li><li>zookeeper | debezium <a href=https://hub.docker.com/r/debezium/zookeeper>https://hub.docker.com/r/debezium/zookeeper</a></li><li>connect | debezium <a href=https://hub.docker.com/r/debezium/connect>https://hub.docker.com/r/debezium/connect</a></li><li>schema-registry | confluentinc <a href=https://hub.docker.com/r/confluentinc/cp-schema-registry>https://hub.docker.com/r/confluentinc/cp-schema-registry</a></li></ul><p>psï¼š
debezium å‚è€ƒåœ°å€ <a href=https://github.com/debezium/docker-images>https://github.com/debezium/docker-images</a>
confluentinc å‚è€ƒåœ°å€ <a href=https://github.com/confluentinc/cp-all-in-one/tree/latest/cp-all-in-one>https://github.com/confluentinc/cp-all-in-one/tree/latest/cp-all-in-one</a></p><h3 id=31-k8såŸºç¡€çŸ¥è¯†>3.1 K8SåŸºç¡€çŸ¥è¯†</h3><ul><li>kafka ä¸ zookeeper å»ºè®¾ä¸º stateful çŠ¶æ€é›†ç¾¤</li><li>schema-registry ä¸»è¦ä¸ºäº† æ”¯æŒ avro æ ¼å¼è¿™äº›ä¸éœ€è¦å†™åˆ° kafka æ¶ˆæ¯å¤´é‡Œé¢ï¼Œå‡å°‘æ¶ˆæ¯çš„å¤§å°ï¼Œé¢å¤–çš„æœåŠ¡ï¼Œå±äº kafka ç”Ÿæ€ï¼Œå­˜å‚¨ä¾èµ– kafka brokerä¿è¯ç¨³å®šæ€§ã€‚</li><li>k8s steteful é›†ç¾¤ 0&mldr;~ n ä¸ª POD</li><li>zookeeper é‡Œé¢ zoo.cfg æŒ‡å®šçš„æ˜¯ä» 1 å¼€å§‹</li><li>kafka é‡Œé¢ broker ä¹Ÿæ˜¯ä» 1 å¼€å§‹</li></ul><h3 id=32-zookeeper-æ„å»º>3.2 zookeeper æ„å»º</h3><ul><li>å¯¹åº”çš„ docker-entrypoint.sh éœ€è¦æ”¹å†™ï¼Œæ³¨é‡ zoo.cfg çš„ç”Ÿæˆ</li><li>å¼€æ”¾ 2888 ç«¯å£ 3888 ç«¯å£ 2181 ç«¯å£</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># ä½¿ç”¨çš„ debezium zk é•œåƒ</span>
</span></span><span style=display:flex><span><span style=color:#75715e># https://github.com/debezium/docker-images/blob/master/zookeeper/1.4/README.md</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>zookeeper-hs</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>zookeeper</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>port</span>: <span style=color:#ae81ff>2888</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>server</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>port</span>: <span style=color:#ae81ff>3888</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>leader-election</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>port</span>: <span style=color:#ae81ff>2181</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>client</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterIP</span>: <span style=color:#ae81ff>None</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>zookeeper</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>StatefulSet</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>zookeeper</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>zookeeper</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>serviceName</span>: <span style=color:#ae81ff>zookeeper-hs</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>updateStrategy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>RollingUpdate</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>podManagementPolicy</span>: <span style=color:#ae81ff>OrderedReady</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>zookeeper</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>affinity</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>podAntiAffinity</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>requiredDuringSchedulingIgnoredDuringExecution</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>labelSelector</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>matchExpressions</span>:
</span></span><span style=display:flex><span>                  - <span style=color:#f92672>key</span>: <span style=color:#e6db74>&#34;app&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>operator</span>: <span style=color:#ae81ff>In</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>values</span>:
</span></span><span style=display:flex><span>                      - <span style=color:#ae81ff>zookeeper</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>topologyKey</span>: <span style=color:#e6db74>&#34;kubernetes.io/hostname&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>securityContext</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>fsGroup</span>: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>runAsUser</span>: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>zookeeper</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>imagePullPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>: <span style=color:#ae81ff>debezium/zookeeper:1.3</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>2181</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: <span style=color:#ae81ff>client</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>2888</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: <span style=color:#ae81ff>server</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>3888</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: <span style=color:#ae81ff>leader-election</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>50m</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>1500Mi</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>command</span>:
</span></span><span style=display:flex><span>            - <span style=color:#ae81ff>bash</span>
</span></span><span style=display:flex><span>            - -<span style=color:#ae81ff>ec</span>
</span></span><span style=display:flex><span>            - |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              if [ ! -d &#34;/zookeeper/zdata/data&#34; ];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                mkdir /zookeeper/zdata/data
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              if [ ! -d &#34;/zookeeper/zdata/txns&#34; ];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                mkdir /zookeeper/zdata/txns
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              export INDEX=${HOSTNAME##*-}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              echo $INDEX
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              export SERVER_ID=$(( INDEX + 1 ))
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              export SERVER_COUNT=3
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              export LOG_LEVEL=INFO
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              cp -rn $ZK_HOME/conf.orig/* $ZK_HOME/conf
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              sed -i -r -e &#34;s|\\$\\{zookeeper.root.logger\\}|$LOG_LEVEL, CONSOLE|g&#34; $ZK_HOME/conf/log4j.properties
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              sed -i -r -e &#34;s|\\$\\{zookeeper.console.threshold\\}|$LOG_LEVEL|g&#34; $ZK_HOME/conf/log4j.properties
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              echo &#34;&#34; &gt;&gt; $ZK_HOME/conf/zoo.cfg
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              echo &#34;#Server List&#34; &gt;&gt; $ZK_HOME/conf/zoo.cfg
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              for i in $( eval echo {1..$SERVER_COUNT});do
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  export HS_INDEX=$((i - 1))
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  if [ &#34;$SERVER_ID&#34; = &#34;$i&#34; ];then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                      echo &#34;server.$i=0.0.0.0:2888:3888&#34; &gt;&gt; $ZK_HOME/conf/zoo.cfg
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  else
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                      echo &#34;server.$i=zookeeper-$HS_INDEX.zookeeper-hs:2888:3888&#34; &gt;&gt; $ZK_HOME/conf/zoo.cfg
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              done
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              echo ${SERVER_ID} &gt; $ZK_HOME/zdata/data/myid
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              sed -i &#34;s|/zookeeper/data|/zookeeper/zdata/data|g&#34; $ZK_HOME/conf/zoo.cfg
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              sed -i &#34;s|/zookeeper/txns|/zookeeper/zdata/txns|g&#34; $ZK_HOME/conf/zoo.cfg
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              export ZOOCFGDIR=&#34;$ZK_HOME/conf&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              export ZOOCFG=&#34;zoo.cfg&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              exec $ZK_HOME/bin/zkServer.sh start-foreground</span>              
</span></span><span style=display:flex><span>          <span style=color:#f92672>volumeMounts</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>zk-data</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>mountPath</span>: <span style=color:#ae81ff>/zookeeper/zdata</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>volumeClaimTemplates</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>zk-data</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>accessModes</span>: [ <span style=color:#e6db74>&#34;ReadWriteOnce&#34;</span> ]
</span></span><span style=display:flex><span>      <span style=color:#f92672>storageClassName</span>: <span style=color:#ae81ff>alicloud-disk-efficiency</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>20Gi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>zookeeper-hs</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>zookeeper</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>port</span>: <span style=color:#ae81ff>2888</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>server</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>port</span>: <span style=color:#ae81ff>3888</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>leader-election</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>port</span>: <span style=color:#ae81ff>2181</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>client</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>clusterIP</span>: <span style=color:#ae81ff>None</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>zookeeper</span>
</span></span></code></pre></div><p>å‚è€ƒæ–‡æ¡£ <a href=https://github.com/debezium/docker-images/blob/master/zookeeper/1.3/README.md>https://github.com/debezium/docker-images/blob/master/zookeeper/1.3/README.md</a></p><h3 id=33-kafka-æ„å»º>3.3 kafka æ„å»º</h3><ul><li>Kafka BrokerID è¦å˜æ›´ï¼Œé€šè¿‡ POD çš„ Index</li><li>KAFKA_LISTENERS ä¸ KAFKA_ADVERTISED_LISTENERS çš„é…ç½®</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>StatefulSet</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>kafka</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>serviceName</span>: <span style=color:#ae81ff>kafka</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>updateStrategy</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>RollingUpdate</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>podManagementPolicy</span>: <span style=color:#ae81ff>OrderedReady</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>kafka</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>affinity</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>podAntiAffinity</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>requiredDuringSchedulingIgnoredDuringExecution</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>labelSelector</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>matchExpressions</span>:
</span></span><span style=display:flex><span>                  - <span style=color:#f92672>key</span>: <span style=color:#e6db74>&#34;app&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>operator</span>: <span style=color:#ae81ff>In</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>values</span>:
</span></span><span style=display:flex><span>                      - <span style=color:#ae81ff>kafka</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>topologyKey</span>: <span style=color:#e6db74>&#34;kubernetes.io/hostname&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>securityContext</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>fsGroup</span>: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>runAsUser</span>: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>imagePullPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>: <span style=color:#ae81ff>debezium/kafka:1.3</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>9092</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>9093</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>100m</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>1500Mi</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>ZOOKEEPER_CONNECT</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;zookeeper-0.zookeeper-hs:2181,zookeeper-1.zookeeper-hs:2181,zookeeper-2.zookeeper-hs:2181&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>LOG_LEVEL</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;INFO&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;2&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>KAFKA_LISTENER_SECURITY_PROTOCOL_MAP</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;PLAINTEXT:PLAINTEXT,EXTERNAL_PLAINTEXT:PLAINTEXT&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>KAFKA_INTER_BROKER_LISTENER_NAME</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;PLAINTEXT&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>KAFKA_LISTENERS</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;PLAINTEXT://0.0.0.0:9092,EXTERNAL_PLAINTEXT://0.0.0.0:9093&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>POD_IP</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>valueFrom</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>fieldRef</span>:
</span></span><span style=display:flex><span>                  <span style=color:#f92672>fieldPath</span>: <span style=color:#ae81ff>status.podIP</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>command</span>:
</span></span><span style=display:flex><span>            - <span style=color:#ae81ff>bash</span>
</span></span><span style=display:flex><span>            - -<span style=color:#ae81ff>ec</span>
</span></span><span style=display:flex><span>            - |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              export INDEX=${HOSTNAME##*-}
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              export BROKER_ID=$((INDEX + 1))
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              PORT=$((INDEX + 9093))
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              export JMX_PORT=$((INDEX + 9999))
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              export KAFKA_ADVERTISED_LISTENERS=&#34;PLAINTEXT://${POD_IP}:9092,EXTERNAL_PLAINTEXT://${LB_IP}:${PORT}&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              exec /docker-entrypoint.sh start</span>              
</span></span><span style=display:flex><span>          <span style=color:#f92672>volumeMounts</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-data</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>mountPath</span>: <span style=color:#ae81ff>/kafka/data</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>volumeClaimTemplates</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-data</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>accessModes</span>: [ <span style=color:#e6db74>&#34;ReadWriteOnce&#34;</span> ]
</span></span><span style=display:flex><span>        <span style=color:#f92672>storageClassName</span>: <span style=color:#ae81ff>alicloud-disk-efficiency</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>storage</span>: <span style=color:#ae81ff>20Gi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-{index}</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># å‚è€ƒé˜¿é‡Œäº‘LB Service é…ç½® è‡ªåŠ¨åˆ›å»º å¥½å‡ ç§ LBç±»å‹ï¼Œè¿™è¾¹æ˜¯å†…ç½‘LB</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>service.beta.kubernetes.io/alicloud-loadbalancer-address-type</span>: <span style=color:#ae81ff>intranet</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>service.beta.kubernetes.io/alicloud-loadbalancer-id</span>: {<span style=color:#ae81ff>LBå®ä¾‹ID}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>service.beta.kubernetes.io/alicloud-loadbalancer-force-override-listeners</span>: <span style=color:#e6db74>&#39;true&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>externalTrafficPolicy</span>: <span style=color:#ae81ff>Local</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>type</span>: <span style=color:#ae81ff>LoadBalancer</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>statefulset.kubernetes.io/pod-name</span>: <span style=color:#ae81ff>kafka-{index}</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>external</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: {{ <span style=color:#ae81ff>9093</span> <span style=color:#ae81ff>+ index }}</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>9093</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>jmx</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: {{ <span style=color:#ae81ff>9999</span> <span style=color:#ae81ff>+ index }}</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>targetPort</span>: {{ <span style=color:#ae81ff>9999</span> <span style=color:#ae81ff>+ index }}</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>internal</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>9092</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>9092</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>piVersion</span>: <span style=color:#ae81ff>networking.k8s.io/v1beta1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Ingress</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-manager</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>nginx.ingress.kubernetes.io/enable-global-auth</span>: <span style=color:#e6db74>&#34;false&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>host</span>: <span style=color:#ae81ff>kafka-manager.{åŸŸå}.com</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>paths</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>backend</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>serviceName</span>: <span style=color:#ae81ff>kafka-manager</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>servicePort</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-manager</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>kafka-manager</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>http</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>9000</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>kafka-manager</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-manager</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>kafka-manager</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>kafka-manager</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>kafka-manager</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-manager</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>imagePullPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>: <span style=color:#ae81ff>dockerkafka/kafka-manager</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>9000</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>ZK_HOSTS</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;zookeeper-0.zookeeper-hs:2181,zookeeper-1.zookeeper-hs:2181,zookeeper-2.zookeeper-hs:2181&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>40m</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>500Mi</span>
</span></span></code></pre></div><p>å‚è€ƒæ–‡æ¡£ <a href=https://github.com/debezium/docker-images/blob/master/kafka/1.4/README.md>https://github.com/debezium/docker-images/blob/master/kafka/1.4/README.md</a></p><h3 id=33-kafka-schema-registry-æ„å»º>3.3 kafka schema-registry æ„å»º</h3><ul><li>Docker åŸºç¡€é•œåƒç¯å¢ƒå¯åŠ¨è„šæœ¬ <a href=https://github.com/confluentinc/schema-registry-images/blob/master/schema-registry/include/etc/confluent/docker/>https://github.com/confluentinc/schema-registry-images/blob/master/schema-registry/include/etc/confluent/docker/</a></li><li>å…ˆå¯åŠ¨ pod å†æ˜ å°„ serviceï¼Œå¦åˆ™å¯åŠ¨æŠ¥é”™, åœ¨è¿™ä¸ªé¡¹ç›®é‡Œé¢æœ‰ä¸ª SCHEMA_REGISTRY_PORT,åœ¨åŸºç¡€å¯åŠ¨è„šæœ¬é‡Œé¢ä¼šä¸»åŠ¨é€€å‡º</li><li>é…ç½® ZK çš„è¯ï¼Œåœ¨kafka listener é‡Œé¢è¦æœ‰ç±»å‹ PLAINTEXTï¼Œ é›†ç¾¤å†…ç½‘å¤–ç½‘ç¯å¢ƒé…ç½®äº† KAFKA_LISTENER_SECURITY_PROTOCOL_MAPï¼ŒæŒ‰ç…§æ­£å¸¸çš„Kafkaæ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯ schema-registry å®ç°çš„æ˜¯æ²¡æœ‰å»æ‰¾çš„ï¼Œæœªåšæ˜ å°„ï¼Œåªè¦æ²¡æœ‰ PLAINTEXT å°±æŠ¥é”™é€€å‡ºï¼Œå¯åŠ¨å¤±è´¥</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>schema-registry</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>schema-registry</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>schema-registry</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>schema-registry</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>securityContext</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>fsGroup</span>: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>runAsUser</span>: <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>schema-registry</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>imagePullPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>: <span style=color:#ae81ff>confluentinc/cp-schema-registry:6.0.0</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>8081</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>SCHEMA_REGISTRY_HOST_NAME</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#ae81ff>schema-registry</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>SCHEMA_REGISTRY_KAFKASTORE_CONNECTION_URL</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#ae81ff>zookeeper-0.zookeeper-hs:2181,zookeeper-1.zookeeper-hs:2181,zookeeper-2.zookeeper-hs:2181</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>SCHEMA_REGISTRY_KAFKASTORE_BOOTSTRAP_SERVERS</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#ae81ff>kafka-0:9092,kafka-1:9092,kafka-2:9092</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>40m</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>500Mi</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>schema-registry</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>schema-registry</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>http</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>8081</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>schema-registry</span>
</span></span></code></pre></div><p>å‚è€ƒæ–‡æ¡£ <a href=https://github.com/confluentinc/cp-all-in-one/blob/latest/cp-all-in-one-cloud/docker-compose.yml>https://github.com/confluentinc/cp-all-in-one/blob/latest/cp-all-in-one-cloud/docker-compose.yml</a></p><h3 id=33-kafka-connect-å»ºè®¾>3.3 kafka connect å»ºè®¾</h3><ul><li>é…ç½®å‚æ•° ç­‰ç­‰ <a href=http://kafka.apache.org/documentation/#connectconfigs>http://kafka.apache.org/documentation/#connectconfigs</a></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>connect</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>connect</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>http</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>8083</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>connect</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>connect</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>connect</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>connect</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>connect</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>connect</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>imagePullPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>: <span style=color:#ae81ff>debezium/connect:1.3</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>8083</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>LOG_LEVEL</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;INFO&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>BOOTSTRAP_SERVERS</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;kafka-0:9092,kafka-1:9092,kafka-2:9092&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>GROUP_ID</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;test_connect&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>CONFIG_STORAGE_TOPIC</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;test_connect_configs&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>OFFSET_STORAGE_TOPIC</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;test_connect_offset&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>STATUS_STORAGE_TOPIC</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;test_connect_status&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>KEY_CONVERTER</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;io.confluent.connect.avro.AvroConverter&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>VALUE_CONVERTER</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;io.confluent.connect.avro.AvroConverter&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>INTERNAL_KEY_CONVERTER</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;org.apache.kafka.connect.json.JsonConverter&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>INTERNAL_VALUE_CONVERTER</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;org.apache.kafka.connect.json.JsonConverter&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>CONNECT_KEY_CONVERTER_SCHEMA_REGISTRY_UR</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;http://schema-registry:8081&#34;</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>CONNECT_VALUE_CONVERTER_SCHEMA_REGISTRY_UR</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;http://schema-registry:8081&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>40m</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>500Mi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ä½¿ç”¨ kafka-connect-uiæ„å»º</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>networking.k8s.io/v1beta1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Ingress</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-connect-ui</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>nginx.ingress.kubernetes.io/enable-global-auth</span>: <span style=color:#e6db74>&#34;false&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>host</span>: <span style=color:#ae81ff>kafka-connect.{åŸŸå}.com</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>http</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>paths</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>backend</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>serviceName</span>: <span style=color:#ae81ff>kafka-connect-ui</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>servicePort</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Service</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-connect-ui</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>kafka-connect-ui</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>http</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>port</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>targetPort</span>: <span style=color:#ae81ff>8000</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>kafka-connect-ui</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-connect-ui</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>app</span>: <span style=color:#ae81ff>kafka-connect-ui</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>app</span>: <span style=color:#ae81ff>kafka-connect-ui</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>app</span>: <span style=color:#ae81ff>kafka-connect-ui</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>kafka-connect-ui</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>imagePullPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>: <span style=color:#ae81ff>landoop/kafka-connect-ui</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>8000</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>CONNECT_URL</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;http://connect&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>requests</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>cpu</span>: <span style=color:#ae81ff>40m</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>memory</span>: <span style=color:#ae81ff>500Mi</span>
</span></span></code></pre></div><p>å‚è€ƒæ–‡æ¡£</p><ul><li><a href=https://github.com/debezium/docker-images/blob/master/connect/1.4/README.md>https://github.com/debezium/docker-images/blob/master/connect/1.4/README.md</a></li><li><a href=https://github.com/debezium/debezium-examples/blob/master/tutorial/docker-compose-mysql-avro-connector.yaml>https://github.com/debezium/debezium-examples/blob/master/tutorial/docker-compose-mysql-avro-connector.yaml</a></li></ul><h1 id=æ•°æ®æ¹–ç¯‡>æ•°æ®æ¹–ç¯‡</h1><h2 id=1hudi-data-lake>1ã€Hudi Data Lakeï¼Ÿ</h2><p>ä¹‹å‰æ„å»ºäº†åŸºäº <code>Debezium</code> æ•è·åŸºæœ¬çš„æ•°æ®å˜åŒ–ï¼Œå‘é€è‡³ <code>Kafka</code>, åé¢çš„å¯¹æ¥æ–¹å¯ä»¥æ˜¯å“ªäº›å‘¢ï¼Ÿè¿™äº›æ˜¯è¦å¤„ç†çš„&mldr;&mldr;</p><p>Apache Hudi æ˜¯æ„å»ºåœ¨ HDFS/S3 ç­‰å¤§æ•°æ®é‡çš„å­˜å‚¨ï¼Œæ—¨åœ¨è§£å†³å¤§æ•°æ®ç”Ÿæ€ç³»ç»Ÿä¸­éœ€è¦<code>æ’å…¥æ›´æ–°</code>åŠ<code>å¢é‡æ¶ˆè´¹</code>çš„æ‘„å–ç®¡é“å’Œ <code>ETLç®¡é“çš„ä½æ•ˆ</code>é—®é¢˜ã€‚</p><ul><li><p>Near Real-Time Ingestion ï¼ˆè¿‘å®æ—¶è·å–ï¼‰</p><p>å°†æ•°æ®ä»å¤–éƒ¨æ•°æ®<code>event logs, databases, external sources</code>æå–åˆ°<code>Hadoop Data Lake</code>ã€‚
å¯¹äº<code>RDBMS</code>æ‘„å–ï¼Œ<code>Hudi</code>é€šè¿‡<code>Upserts</code>æä¾›äº†æ›´å¿«çš„è´Ÿè½½ï¼Œ</p></li><li><p>Near Real-time Analytics ï¼ˆè¿‘å®æ—¶åˆ†æï¼‰</p><p><code>Hadoopä¸Š</code>çš„äº¤äº’å¼SQLè§£å†³æ–¹æ¡ˆï¼ˆå¦‚<code>Presto</code>å’Œ<code>SparkSQL</code>ï¼‰ã€‚é€šè¿‡<code>Hudi</code>å°†æ•°æ®çš„æ›´æ–°æ—¶é—´ç¼©çŸ­è‡³å‡ åˆ†é’Ÿï¼Œè¿˜å¯ä»¥å¯¹å­˜å‚¨åœ¨<code>DFS</code>ä¸­çš„å¤šä¸ªå¤§å°æ›´å¤§çš„è¡¨è¿›è¡Œå®æ—¶åˆ†æã€‚
è€Œä¸”ï¼Œ<code>Hudi</code> æ²¡æœ‰å¤–éƒ¨ä¾èµ–é¡¹ï¼ˆå¦‚<code>HBase</code>ç¾¤é›†ï¼‰ï¼Œå› æ­¤å¯ä»¥åœ¨ä¸å¢åŠ è¿è¥å¼€é”€çš„æƒ…å†µä¸‹ï¼Œå¯¹æ›´æ–°é²œçš„åˆ†æè¿›è¡Œæ›´å¿«çš„åˆ†æã€‚</p></li><li><p>Incremental Processing Pipelines ï¼ˆå¢é‡å¤„ç†ç®¡é“ï¼‰</p></li><li><p>Data Dispersal From DFS ï¼ˆåˆ†æ•£æ•°æ®ï¼‰</p></li></ul><p><img src=/Kafka%E4%B8%8EDebezium%E6%9E%84%E5%BB%BACDC%E7%AE%A1%E9%81%93/hudi-lake.png alt=Hudiæ¶æ„></p><h2 id=2timeline>2ã€Timeline</h2><p>Hudiçš„æ ¸å¿ƒæ˜¯ç»´æŠ¤<code>timeline</code>åœ¨ä¸åŒ<code>instants</code>æ—¶é—´ä¸Šå¯¹è¡¨ä¸Šæ‰§è¡Œçš„æ‰€æœ‰æ“ä½œä¸­ä¸€ä¸ªæ“ä½œï¼Œè¿™æœ‰åŠ©äºæä¾›è¡¨çš„å³æ—¶è§†å›¾ï¼Œ
åŒæ—¶è¿˜æœ‰æ•ˆåœ°æ”¯æŒæŒ‰åˆ°è¾¾é¡ºåºå¯¹æ•°æ®è¿›è¡Œæ£€ç´¢ã€‚</p><p>Hudiç¬é—´åŒ…å«ä»¥ä¸‹ç»„ä»¶</p><ul><li>Instant action ï¼šåœ¨è¡¨æ ¼ä¸Šæ‰§è¡Œçš„æ“ä½œç±»å‹</li><li>Instant time ï¼šå³æ—¶æ—¶é—´é€šå¸¸æ˜¯ä¸€ä¸ªæ—¶é—´æˆ³è®°ï¼ˆä¾‹å¦‚ï¼š20190117010349ï¼‰ï¼Œè¯¥æ—¶é—´æˆ³è®°ä»¥åŠ¨ä½œå¼€å§‹æ—¶é—´çš„é¡ºåºå•è°ƒå¢åŠ ã€‚</li><li>state ï¼šå³æ—¶çŠ¶æ€</li></ul><p>Hudiä¿è¯åœ¨<code>timeline</code>ä¸Šæ‰§è¡Œçš„æ“ä½œåŸºäºå½“å‰æ—¶é—´æ˜¯åŸå­æ€§å’Œæ—¶é—´è½´ä¸Šä¸€è‡´çš„ã€‚</p><p>æ‰§è¡Œçš„å…³é”®åŠ¨ä½œåŒ…æ‹¬</p><ul><li>COMMITS - æäº¤è®°å½• ä¸€æ‰¹è®°å½•åŸå­å†™å…¥è¡¨ä¸­ æäº¤è¡¨ç¤ºå°†ä¸€æ‰¹è®°å½•åŸå­å†™å…¥è¡¨ä¸­ã€‚</li><li>CLEANS - åå°æ¸…é™¤è¡¨ä¸­ä¸éœ€è¦çš„æ–‡ä»¶æ—§ç‰ˆæœ¬è®°å½•ã€‚</li><li>DELTA_COMMIT - å¢é‡æäº¤æ˜¯æŒ‡å°†ä¸€æ‰¹è®°å½•åŸå­å†™å…¥<code>MergeOnRead</code>ç±»å‹è¡¨ä¸­ï¼Œå…¶ä¸­ä¸€äº›/æ‰€æœ‰ æ•°æ® å¯ä»¥åªå†™åˆ°å¢é‡æ—¥å¿—ä¸­ã€‚</li><li>COMPACTION - è°ƒå’Œ<code>Hudi</code>ä¸­ä¸åŒæ•°æ®ç»“æ„çš„åå°æ´»åŠ¨ï¼Œä¾‹å¦‚ï¼šå°†æ›´æ–°ä»åŸºäºè¡Œçš„æ—¥å¿—æ–‡ä»¶ç§»åŠ¨åˆ°åˆ—æ ¼å¼ã€‚åœ¨å†…éƒ¨ï¼Œå‹ç¼©è¡¨ç°ä¸ºæ—¶é—´è½´ä¸Šçš„ç‰¹æ®Šæäº¤</li><li>ROLLBACK - è¡¨ç¤ºæäº¤/å¢é‡æäº¤ä¸æˆåŠŸä¸”å·²å›æ»šï¼Œåˆ é™¤äº†åœ¨å†™å…¥è¿‡ç¨‹ä¸­äº§ç”Ÿçš„ä»»ä½•éƒ¨åˆ†æ–‡ä»¶</li><li>SAVEPOINT - å°†æŸäº›æ–‡ä»¶ç»„æ ‡è®°ä¸ºâ€œå·²ä¿å­˜â€ï¼Œä»¥ä¾¿æ¸…ç†ç¨‹åºä¸ä¼šåˆ é™¤å®ƒä»¬ã€‚åœ¨å‘ç”Ÿç¾éš¾/æ•°æ®æ¢å¤çš„æƒ…å†µä¸‹ï¼Œå®ƒæœ‰åŠ©äºå°†è¡¨è¿˜åŸåˆ°æ—¶é—´è½´ä¸Šçš„æŸä¸ªç‚¹ã€‚</li></ul><p>ä»»ä½•ç»™å®šçš„ç¬é—´éƒ½å¯ä»¥å¤„äºä»¥ä¸‹çŠ¶æ€ä¹‹ä¸€</p><ul><li>REQUESTED -è¡¨ç¤ºå·²ç»å®‰æ’äº†åŠ¨ä½œï¼Œä½†å°šæœªå¼€å§‹</li><li>INFLIGHT -è¡¨ç¤ºå½“å‰æ­£åœ¨æ‰§è¡Œè¯¥æ“ä½œ</li><li>COMPLETED -è¡¨ç¤ºåœ¨æ—¶é—´è¡¨ä¸Šå®Œæˆäº†ä¸€é¡¹æ“ä½œ
<img src=/Kafka%E4%B8%8EDebezium%E6%9E%84%E5%BB%BACDC%E7%AE%A1%E9%81%93/hudi_c.png alt=COW></li></ul><h2 id=3hudi-çš„å­˜å‚¨ç±»å‹>3ã€Hudi çš„å­˜å‚¨ç±»å‹</h2><ul><li><p>COW Copy On Write å¿«ç…§æŸ¥è¯¢ + å¢é‡æŸ¥è¯¢</p><p>æ•°æ®ä»…ä»…ä»¥ åˆ—æ–‡ä»¶æ ¼å¼ parquet å­˜å‚¨ï¼Œæ¯æ¬¡å†™æ“ä½œåæ•°æ®çš„åŒæ­¥ Merge ä»¥æ›´æ–°ç‰ˆæœ¬å¹¶é‡å†™æ–‡ä»¶ï¼ŒCOWè¡¨ä¸­æ•°æ®ä½¿ç”¨æ˜¯æœ€æ–°çš„</p></li></ul><p><img src=/Kafka%E4%B8%8EDebezium%E6%9E%84%E5%BB%BACDC%E7%AE%A1%E9%81%93/hudi_cow.png alt=COW></p><ul><li><p>MOR merge on read å¿«ç…§æŸ¥è¯¢ + å¢é‡æŸ¥è¯¢ + è¯»å–ä¼˜åŒ–</p><p>æ•°æ®ä»¥ åˆ—æ–‡ä»¶æ ¼å¼ parquet å’Œ åŸºäº è¡Œæ–‡ä»¶æ ¼å¼ avro ç»„åˆå­˜å‚¨ã€‚æ¯æ¬¡å†™å…¥æ“ä½œå°†å¢é‡åˆ›å»ºæ–‡ä»¶ã€‚ç„¶å compact ä»¥ç”Ÿæˆ åˆ—æ–‡ä»¶ çš„æœ€æ–°ç‰ˆ</p></li></ul><p><img src=/Kafka%E4%B8%8EDebezium%E6%9E%84%E5%BB%BACDC%E7%AE%A1%E9%81%93/hudi_mor.png alt=MOR></p></div></article><div class=blog-post-comments><div id=disqus_thread><script type=text/javascript>(function(){var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="pinkhello",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/categories>Category</a></li><li><a href=/tags>Tag</a></li><li><a href=/index.xml>Rss</a></li><li><a href=/jobs>Job</a></li></ul></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&text=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&title=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&is_video=false&description=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93&body=Check out this article: https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&title=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&title=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&name=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93&description=%e5%bb%ba%e8%ae%be%e7%af%87%201%e3%80%81%e4%bb%80%e4%b9%88%e6%98%af%20debezium%3f%20https%3a%2f%2fdebezium.io%2f%0aTutorial%20https%3a%2f%2fdebezium.io%2fdocumentation%2freference%2f1.3%2ftutorial.html%0a2%e3%80%81Debezium%20%e5%a6%82%e4%bd%95%e5%b7%a5%e4%bd%9c%e7%9a%84%202.1%20Debezium%20%e6%94%af%e6%8c%81%e7%9a%84%e6%95%b0%e6%8d%ae%e5%ba%93%e7%b1%bb%e5%9e%8b%20MySQL%20MongoDB%20PostgreSQL%20Oracle%20SQL%20Server%20Db2%20Cassandra%202.2%20Debezium%20%e4%b8%89%e7%a7%8d%e6%96%b9%e5%bc%8f%e8%bf%90%e8%a1%8c%20Kafka%20Connect%20Debezium%20Server%20Embedded%20Engine%20https%3a%2f%2fgithub.com%2fdebezium%2fdebezium-examples%2ftree%2fmaster%2fkinesis%0a3%e3%80%81%e5%9c%a8%20K8S%20%e4%b8%ad%e6%9e%84%e5%bb%ba%e5%9f%ba%e7%a1%80Debezium%e9%9b%86%e7%be%a4%e7%8e%af%e5%a2%83%20%e9%95%9c%e5%83%8f%e5%87%86%e5%a4%87%0akafka%20%7c%20debezium%20https%3a%2f%2fhub.docker.com%2fr%2fdebezium%2fkafka%20zookeeper%20%7c%20debezium%20https%3a%2f%2fhub.docker.com%2fr%2fdebezium%2fzookeeper%20connect%20%7c%20debezium%20https%3a%2f%2fhub.docker.com%2fr%2fdebezium%2fconnect%20schema-registry%20%7c%20confluentinc%20https%3a%2f%2fhub.docker.com%2fr%2fconfluentinc%2fcp-schema-registry%20ps%ef%bc%9a%20debezium%20%e5%8f%82%e8%80%83%e5%9c%b0%e5%9d%80%20https%3a%2f%2fgithub.com%2fdebezium%2fdocker-images%20confluentinc%20%e5%8f%82%e8%80%83%e5%9c%b0%e5%9d%80%20https%3a%2f%2fgithub.com%2fconfluentinc%2fcp-all-in-one%2ftree%2flatest%2fcp-all-in-one%0a3.1%20K8S%e5%9f%ba%e7%a1%80%e7%9f%a5%e8%af%86%20kafka%20%e4%b8%8e%20zookeeper%20%e5%bb%ba%e8%ae%be%e4%b8%ba%20stateful%20%e7%8a%b6%e6%80%81%e9%9b%86%e7%be%a4%20schema-registry%20%e4%b8%bb%e8%a6%81%e4%b8%ba%e4%ba%86%20%e6%94%af%e6%8c%81%20avro%20%e6%a0%bc%e5%bc%8f%e8%bf%99%e4%ba%9b%e4%b8%8d%e9%9c%80%e8%a6%81%e5%86%99%e5%88%b0%20kafka%20%e6%b6%88%e6%81%af%e5%a4%b4%e9%87%8c%e9%9d%a2%ef%bc%8c%e5%87%8f%e5%b0%91%e6%b6%88%e6%81%af%e7%9a%84%e5%a4%a7%e5%b0%8f%ef%bc%8c%e9%a2%9d%e5%a4%96%e7%9a%84%e6%9c%8d%e5%8a%a1%ef%bc%8c%e5%b1%9e%e4%ba%8e%20kafka%20%e7%94%9f%e6%80%81%ef%bc%8c%e5%ad%98%e5%82%a8%e4%be%9d%e8%b5%96%20kafka%20broker%e4%bf%9d%e8%af%81%e7%a8%b3%e5%ae%9a%e6%80%a7%e3%80%82%20k8s%20steteful%20%e9%9b%86%e7%be%a4%200%26hellip%3b~%20n%20%e4%b8%aa%20POD%20zookeeper%20%e9%87%8c%e9%9d%a2%20zoo." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fpinkhello.cc%2fposts%2f13-kafka%25E4%25B8%258Edebezium%25E6%259E%2584%25E5%25BB%25BAcdc%25E7%25AE%25A1%25E9%2581%2593%2f&t=Kafka%e4%b8%8eDebezium%e6%9e%84%e5%bb%baCDC%e7%ae%a1%e9%81%93" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2023 pinkhello</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Posts</a></li><li><a href=/categories>Category</a></li><li><a href=/tags>Tag</a></li><li><a href=/index.xml>Rss</a></li><li><a href=/jobs>Job</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script><script src=/js/code-copy.js></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></html>